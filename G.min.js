(function(){function e(){this._callbacks=[]}function t(t){function o(e){return function(){i+=1;r[e]=Array.prototype.slice.call(arguments);if(i===s)n.done(r)}}var n=new e;var r=[];if(!t||!t.length){n.done(r);return n}var i=0;var s=t.length;for(var u=0;u<s;u++){t[u].then(o(u))}return n}function n(t,r){var i=new e;if(t.length===0){i.done.apply(i,r)}else{t[0].apply(null,r).then(function(){t.splice(0,1);n(t,arguments).then(function(){i.done.apply(i,arguments)})})}return i}function r(e){var t="";if(typeof e==="string"){t=e}else{var n=encodeURIComponent;for(var r in e){if(e.hasOwnProperty(r)){t+="&"+n(r)+"="+n(e[r])}}}return t}function i(){var e;if(window.XMLHttpRequest){e=new XMLHttpRequest}else if(window.ActiveXObject){try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){e=new ActiveXObject("Microsoft.XMLHTTP")}}return e}function s(t,n,s,a){function p(){l.abort();f.done(l,null)}var f=new e;var l=i();var c=r(s);s=s||{};a=a||{};a.headers=a.headers||{};a.type=a.type||"json";if(t==="GET"&&c){n+="?"+c;c=null}l.open(t,n);l.setRequestHeader("Content-type","application/x-www-form-urlencoded");for(var h in a.headers){if(a.headers.hasOwnProperty(h)){l.setRequestHeader(h,a.headers[h])}}var d=u.ajaxTimeout;if(d){var v=setTimeout(p,d)}l.onreadystatechange=function(){if(d){clearTimeout(v)}if(l.readyState===4){var e=!l.status||(l.status<200||l.status>=300)&&l.status!==304;var t={};t=o(l,a.type);if(e)f.done(t,null);else f.done(null,t.response,t)}};l.send(c);return f}function o(e,t){xhr_parsed={};for(var n in e){if(e.hasOwnProperty(n))xhr_parsed[n]=e[n]}if(e.responseText&&t==="json"){try{xhr_parsed.response=JSON.parse(xhr_parsed.responseText)}catch(r){}}else if(t==="xml"){xhr_parsed.response=xhr_parsed.responseXML}return xhr_parsed}e.prototype.then=function(t,n){var r;if(this._is_done){r=t.apply(n,this.result)}else{r=new e;this._callbacks.push(function(){var e=t.apply(n,arguments);if(e&&typeof e.then==="function")e.then(r.done,r)})}return r};e.prototype.done=function(){this.result=arguments;this._is_done=true;for(var e=0;e<this._callbacks.length;e++){this._callbacks[e].apply(null,arguments)}this._callbacks=[]};var u={Promise:e,parallel:t,waterfall:n,ajax:s,ajaxTimeout:null};window.G=u})()